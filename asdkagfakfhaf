-- Script de Teleport a Jugadores para Roblox
-- Compatible con ejecutores como Solara

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")

-- Variables globales
local selectedPlayer = nil
local teleporting = false
local connection = nil

-- Crear GUI
local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local Title = Instance.new("TextLabel")
local PlayerDropdown = Instance.new("TextButton")
local DropdownFrame = Instance.new("ScrollingFrame")
local TeleportButton = Instance.new("TextButton")
local StopButton = Instance.new("TextButton")
local StatusLabel = Instance.new("TextLabel")
local UICorner1 = Instance.new("UICorner")
local UICorner2 = Instance.new("UICorner")
local UICorner3 = Instance.new("UICorner")
local UICorner4 = Instance.new("UICorner")

-- Proteger GUI
if syn then
    syn.protect_gui(ScreenGui)
    ScreenGui.Name = "TeleportGUI_" .. tostring(math.random(1000, 9999))
else
    ScreenGui.Name = "TeleportGUI"
end

ScreenGui.Parent = game:GetService("CoreGui")
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- Configurar MainFrame
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
MainFrame.BorderSizePixel = 0
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -150)
MainFrame.Size = UDim2.new(0, 300, 0, 300)
MainFrame.Active = true
MainFrame.Draggable = true

UICorner1.CornerRadius = UDim.new(0, 10)
UICorner1.Parent = MainFrame

-- Título
Title.Parent = MainFrame
Title.BackgroundTransparency = 1
Title.Position = UDim2.new(0, 0, 0, 0)
Title.Size = UDim2.new(1, 0, 0, 40)
Title.Font = Enum.Font.GothamBold
Title.Text = "Teleport a Jugadores"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 18

-- Dropdown de jugadores
PlayerDropdown.Parent = MainFrame
PlayerDropdown.BackgroundColor3 = Color3.fromRGB(50, 50, 60)
PlayerDropdown.BorderSizePixel = 0
PlayerDropdown.Position = UDim2.new(0.05, 0, 0.17, 0)
PlayerDropdown.Size = UDim2.new(0.9, 0, 0, 35)
PlayerDropdown.Font = Enum.Font.Gotham
PlayerDropdown.Text = "Seleccionar Jugador"
PlayerDropdown.TextColor3 = Color3.fromRGB(255, 255, 255)
PlayerDropdown.TextSize = 14

UICorner2.CornerRadius = UDim.new(0, 6)
UICorner2.Parent = PlayerDropdown

-- Frame del dropdown
DropdownFrame.Parent = MainFrame
DropdownFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 55)
DropdownFrame.BorderSizePixel = 0
DropdownFrame.Position = UDim2.new(0.05, 0, 0.32, 0)
DropdownFrame.Size = UDim2.new(0.9, 0, 0, 0)
DropdownFrame.Visible = false
DropdownFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
DropdownFrame.ScrollBarThickness = 6

-- Botón de teleport
TeleportButton.Parent = MainFrame
TeleportButton.BackgroundColor3 = Color3.fromRGB(60, 180, 75)
TeleportButton.BorderSizePixel = 0
TeleportButton.Position = UDim2.new(0.05, 0, 0.65, 0)
TeleportButton.Size = UDim2.new(0.9, 0, 0, 35)
TeleportButton.Font = Enum.Font.GothamBold
TeleportButton.Text = "Iniciar Teleport"
TeleportButton.TextColor3 = Color3.fromRGB(255, 255, 255)
TeleportButton.TextSize = 14

UICorner3.CornerRadius = UDim.new(0, 6)
UICorner3.Parent = TeleportButton

-- Botón de detener
StopButton.Parent = MainFrame
StopButton.BackgroundColor3 = Color3.fromRGB(220, 50, 50)
StopButton.BorderSizePixel = 0
StopButton.Position = UDim2.new(0.05, 0, 0.78, 0)
StopButton.Size = UDim2.new(0.9, 0, 0, 35)
StopButton.Font = Enum.Font.GothamBold
StopButton.Text = "Detener Teleport"
StopButton.TextColor3 = Color3.fromRGB(255, 255, 255)
StopButton.TextSize = 14
StopButton.Visible = false

UICorner4.CornerRadius = UDim.new(0, 6)
UICorner4.Parent = StopButton

-- Label de estado
StatusLabel.Parent = MainFrame
StatusLabel.BackgroundTransparency = 1
StatusLabel.Position = UDim2.new(0, 0, 0.91, 0)
StatusLabel.Size = UDim2.new(1, 0, 0, 25)
StatusLabel.Font = Enum.Font.Gotham
StatusLabel.Text = "Listo"
StatusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
StatusLabel.TextSize = 12

-- Función para actualizar lista de jugadores
local function UpdatePlayerList()
    for _, child in pairs(DropdownFrame:GetChildren()) do
        if child:IsA("TextButton") then
            child:Destroy()
        end
    end
    
    local yPos = 0
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then
            local PlayerButton = Instance.new("TextButton")
            PlayerButton.Parent = DropdownFrame
            PlayerButton.BackgroundColor3 = Color3.fromRGB(55, 55, 65)
            PlayerButton.BorderSizePixel = 0
            PlayerButton.Position = UDim2.new(0, 0, 0, yPos)
            PlayerButton.Size = UDim2.new(1, -6, 0, 30)
            PlayerButton.Font = Enum.Font.Gotham
            PlayerButton.Text = player.Name
            PlayerButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            PlayerButton.TextSize = 13
            
            PlayerButton.MouseButton1Click:Connect(function()
                selectedPlayer = player
                PlayerDropdown.Text = player.Name
                DropdownFrame.Visible = false
                DropdownFrame.Size = UDim2.new(0.9, 0, 0, 0)
                StatusLabel.Text = "Jugador seleccionado: " .. player.Name
            end)
            
            yPos = yPos + 32
        end
    end
    
    DropdownFrame.CanvasSize = UDim2.new(0, 0, 0, yPos)
end

-- Toggle dropdown
PlayerDropdown.MouseButton1Click:Connect(function()
    DropdownFrame.Visible = not DropdownFrame.Visible
    if DropdownFrame.Visible then
        UpdatePlayerList()
        local playerCount = #Players:GetPlayers() - 1
        local height = math.min(playerCount * 32, 150)
        DropdownFrame.Size = UDim2.new(0.9, 0, 0, height)
    else
        DropdownFrame.Size = UDim2.new(0.9, 0, 0, 0)
    end
end)

-- Función de teleport continuo
local function StartTeleporting()
    if not selectedPlayer then
        StatusLabel.Text = "¡Selecciona un jugador primero!"
        return
    end
    
    teleporting = true
    TeleportButton.Visible = false
    StopButton.Visible = true
    StatusLabel.Text = "Teletransportando a " .. selectedPlayer.Name
    
    connection = RunService.Heartbeat:Connect(function()
        if not teleporting then return end
        
        local targetChar = selectedPlayer.Character
        local localChar = LocalPlayer.Character
        
        if targetChar and targetChar:FindFirstChild("HumanoidRootPart") then
            if localChar and localChar:FindFirstChild("HumanoidRootPart") then
                local targetPos = targetChar.HumanoidRootPart.CFrame
                localChar.HumanoidRootPart.CFrame = targetPos * CFrame.new(0, 2, 3)
            else
                -- Esperar a que el personaje reaparezca
                StatusLabel.Text = "Esperando respawn..."
            end
        else
            StatusLabel.Text = "Objetivo no disponible"
        end
    end)
end

-- Función para detener teleport
local function StopTeleporting()
    teleporting = false
    if connection then
        connection:Disconnect()
        connection = nil
    end
    TeleportButton.Visible = true
    StopButton.Visible = false
    StatusLabel.Text = "Teleport detenido"
end

-- Eventos de botones
TeleportButton.MouseButton1Click:Connect(StartTeleporting)
StopButton.MouseButton1Click:Connect(StopTeleporting)

-- Actualizar cuando se agreguen jugadores
Players.PlayerAdded:Connect(function()
    if DropdownFrame.Visible then
        UpdatePlayerList()
    end
end)

Players.PlayerRemoving:Connect(function(player)
    if selectedPlayer == player then
        StopTeleporting()
        selectedPlayer = nil
        PlayerDropdown.Text = "Seleccionar Jugador"
        StatusLabel.Text = "Jugador seleccionado se fue"
    end
    if DropdownFrame.Visible then
        UpdatePlayerList()
    end
end)

-- Manejar respawn del jugador local
LocalPlayer.CharacterAdded:Connect(function(character)
    if teleporting then
        character:WaitForChild("HumanoidRootPart")
        StatusLabel.Text = "Respawneado - Continuando teleport"
    end
end)

print("Script de Teleport cargado exitosamente!")
StatusLabel.Text = "Script cargado - Selecciona un jugador"
