-- DESOFUSCADOR CON WEBHOOK DE DISCORD (VERSIÃ“N MEJORADA)
-- =========================================================

-- âš™ï¸ CONFIGURACIÃ“N
local WEBHOOK_URL = "https://discordapp.com/api/webhooks/1428139247369584751/8qtb7uwXp6e50WxpzoTlHN4CHwn5oAJo0nKwSTyvOqP7ha9-sl0f-2lxoqjJiPcjWYb1" -- Pon tu webhook completo aquÃ­
local GITHUB_RAW_URL = "https://raw.githubusercontent.com/CoronaBlanca/2198832473482/refs/heads/main/dxsxfxscxtxr%20By%20Shxryx" -- O tu link

-- ğŸ“Š Variables para capturar
local captured_code = {}
local captured_info = {}

print("ğŸ” Iniciando desofuscador...")

-- ğŸª HOOK DE LOADSTRING
local old_loadstring = loadstring or load
_G.loadstring = function(code, ...)
    print("âœ… CÃ³digo capturado! Longitud:", #code)
    table.insert(captured_code, code)
    return old_loadstring(code, ...)
end
loadstring = _G.loadstring

-- ğŸ“¤ FUNCIÃ“N PARA ENVIAR A DISCORD
local function send_to_discord(content, title)
    title = title or "CÃ³digo Desofuscado"
    
    print("ğŸ“¤ Intentando enviar a Discord...")
    
    -- Crear payload
    local data = {
        username = "Desofuscador",
        embeds = {{
            title = "ğŸ”“ " .. title,
            description = "```lua\n" .. content:sub(1, 4000) .. "\n```",
            color = 3447003,
            footer = {
                text = "MoonSec Deobfuscator | " .. os.date("%H:%M:%S")
            }
        }}
    }
    
    -- Intentar diferentes mÃ©todos de HTTP
    local http_methods = {
        -- MÃ©todo 1: syn (Synapse X)
        function()
            local json = game:GetService("HttpService"):JSONEncode(data)
            return syn.request({
                Url = WEBHOOK_URL,
                Method = "POST",
                Headers = {["Content-Type"] = "application/json"},
                Body = json
            })
        end,
        
        -- MÃ©todo 2: http_request (KRNL, Fluxus)
        function()
            local json = game:GetService("HttpService"):JSONEncode(data)
            return http_request({
                Url = WEBHOOK_URL,
                Method = "POST",
                Headers = {["Content-Type"] = "application/json"},
                Body = json
            })
        end,
        
        -- MÃ©todo 3: request (Script-Ware)
        function()
            local json = game:GetService("HttpService"):JSONEncode(data)
            return request({
                Url = WEBHOOK_URL,
                Method = "POST",
                Headers = {["Content-Type"] = "application/json"},
                Body = json
            })
        end
    }
    
    -- Probar cada mÃ©todo
    for i, method in ipairs(http_methods) do
        local success, result = pcall(method)
        if success then
            print("âœ… Enviado con mÃ©todo", i)
            return true
        else
            warn("âŒ MÃ©todo", i, "fallÃ³:", result)
        end
    end
    
    warn("âŒ Todos los mÃ©todos HTTP fallaron")
    return false
end

-- ğŸ’¾ GUARDAR EN ARCHIVO (backup)
local function save_to_file(content, filename)
    filename = filename or "deobfuscated.lua"
    
    if writefile then
        writefile(filename, content)
        print("ğŸ’¾ Guardado en:", filename)
        return true
    else
        warn("âŒ writefile no disponible")
        return false
    end
end

-- ğŸ¯ EJECUTAR Y CAPTURAR
print("ğŸš€ Descargando cÃ³digo...")

-- Descargar el cÃ³digo
local success_download, code = pcall(function()
    if GITHUB_RAW_URL:find("http") then
        return game:HttpGet(GITHUB_RAW_URL)
    else
        return GITHUB_RAW_URL -- Es cÃ³digo directo
    end
end)

if not success_download then
    warn("âŒ Error descargando:", code)
    return
end

print("ğŸ“¦ CÃ³digo descargado. Longitud:", #code)
print("âš¡ Ejecutando cÃ³digo ofuscado...")

-- Ejecutar el cÃ³digo
local success_exec, error_msg = pcall(function()
    loadstring(code)()
end)

if not success_exec then
    warn("âŒ Error ejecutando:", error_msg)
end

-- Esperar a que capture todo
wait(3)

-- ğŸ“‹ PROCESAR RESULTADOS
print("ğŸ“Š Procesando resultados...")

local final_report = ""

if #captured_code > 0 then
    print("ğŸ‰ Se capturÃ³", #captured_code, "cÃ³digo(s)")
    
    for i, captured in ipairs(captured_code) do
        final_report = final_report .. "-- CÃ“DIGO CAPTURADO #" .. i .. "\n"
        final_report = final_report .. "-- Longitud: " .. #captured .. " caracteres\n"
        final_report = final_report .. "-- " .. string.rep("=", 50) .. "\n\n"
        final_report = final_report .. captured .. "\n\n"
    end
else
    final_report = "âš ï¸ No se capturÃ³ ningÃºn cÃ³digo.\n"
    final_report = final_report .. "Esto puede significar que:\n"
    final_report = final_report .. "1. El cÃ³digo no usa loadstring()\n"
    final_report = final_report .. "2. Ya estÃ¡ desofuscado\n"
    final_report = final_report .. "3. Necesita un mÃ©todo de captura diferente\n\n"
    final_report = final_report .. "CÃ³digo original:\n" .. code:sub(1, 2000)
end

-- ğŸ“¤ ENVIAR Y GUARDAR
print("ğŸ“¤ Enviando resultados...")

-- Intentar enviar a Discord
local sent = send_to_discord(final_report, "Resultado de DesofuscaciÃ³n")

-- Siempre guardar en archivo como backup
save_to_file(final_report, "deobfuscated_" .. os.time() .. ".lua")

if sent then
    print("âœ… Â¡Completado! Revisa tu Discord")
else
    print("âš ï¸ No se pudo enviar a Discord, pero se guardÃ³ en archivo")
end

print("ğŸ Proceso terminado")

-- ğŸ“– INFORMACIÃ“N ADICIONAL
print("\n" .. string.rep("=", 60))
print("ğŸ“Š RESUMEN:")
print("- CÃ³digos capturados:", #captured_code)
print("- Webhook configurado:", WEBHOOK_URL ~= "TU_WEBHOOK_AQUI")
print("- Archivo guardado: deobfuscated_" .. os.time() .. ".lua")
print(string.rep("=", 60))
