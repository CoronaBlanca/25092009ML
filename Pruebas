local library = loadstring(game:HttpGet("https://raw.githubusercontent.com/CoronaBlanca/25092009UI/refs/heads/main/Xlxrxxm%20bx%20shxryx", true))()
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local displayName = player.DisplayName ~= "" and player.DisplayName or player.Name
local title = (" Hub | Hello %s"):format(displayName)
local window = library:AddWindow(title, {main_color = Color3.fromRGB(0,0,0), min_size = Vector2.new(650,870), can_resize = true})

local SoundService = game:GetService("SoundService")
local Sound = Instance.new("Sound")
Sound.Name = "GenesisMusic"
Sound.Parent = SoundService
Sound.Volume = 1
Sound.Looped = false

local Playlist = {}
local currentIndex = 0
local isPaused = false
local MP3_URL = ""
local fileName = "GenesisPlaylist_"..player.Name..".txt"
local tempIndex = 0

if isfile(fileName) then
    local data = readfile(fileName)
    for url in string.gmatch(data,"[^,]+") do
        table.insert(Playlist,url)
    end
else
    writefile(fileName,"")
end

local function savePlaylist()
    writefile(fileName,table.concat(Playlist,","))
end

local function loadMP3(url)
    tempIndex = tempIndex + 1
    local tempFile = "GenesisMusic_"..tempIndex..".mp3"
    pcall(function()
        if isfile(tempFile) then delfile(tempFile) end
        writefile(tempFile,game:HttpGet(url))
        Sound.SoundId = getcustomasset(tempFile)
        Sound.Loaded:Wait()
    end)
end

local MusicTab = window:AddTab("ðŸŽ¶ Music Player")
local TimeLabel = MusicTab:AddLabel("â±ï¸ 00:00 / 00:00")

MusicTab:AddTextBox("ðŸŽµ MP3 URL",function(value) MP3_URL = value end,{["clear"]=false})
MusicTab:AddButton("ðŸ“¥ Cargar MP3",function() if MP3_URL~="" then loadMP3(MP3_URL) end end)
MusicTab:AddButton("â–¶ Play",function() pcall(function() if Sound.SoundId=="" and MP3_URL~="" then loadMP3(MP3_URL) end if isPaused then isPaused=false; Sound:Resume() else Sound:Play() end end) end)
MusicTab:AddButton("â¸ Pause",function() pcall(function() if Sound.IsPlaying then Sound:Pause(); isPaused=true end end) end)
MusicTab:AddButton("â¹ Stop",function() pcall(function() Sound:Stop(); Sound.TimePosition=0; isPaused=false end) end)
MusicTab:AddButton("ðŸ”„ Reiniciar",function() if Sound.SoundId~="" then Sound.TimePosition=0; if not Sound.IsPlaying then Sound:Play() end end end)
MusicTab:AddTextBox("ðŸ”Š Volumen (0-5)",function(val) local num=tonumber(val) if num then Sound.Volume=math.clamp(num,0,5) end end,{["clear"]=false})
MusicTab:AddButton("âž• Add to Playlist",function() if MP3_URL~="" then table.insert(Playlist,MP3_URL); savePlaylist() end end)
MusicTab:AddButton("â–¶ï¸ Play Playlist",function() if #Playlist>0 then currentIndex=1; loadMP3(Playlist[currentIndex]); Sound:Play(); isPaused=false end end)
MusicTab:AddButton("â­ï¸ Next",function() if #Playlist>0 then currentIndex=currentIndex+1; if currentIndex>#Playlist then currentIndex=1 end; loadMP3(Playlist[currentIndex]); Sound:Play(); isPaused=false end end)
MusicTab:AddButton("â®ï¸ Previous",function() if #Playlist>0 then currentIndex=currentIndex-1; if currentIndex<1 then currentIndex=#Playlist end; loadMP3(Playlist[currentIndex]); Sound:Play(); isPaused=false end end)
MusicTab:AddButton("ðŸ—‘ï¸ Clear Playlist",function() Playlist={}; savePlaylist(); currentIndex=0 end)
MusicTab:AddToggle("ðŸ” Loop",false,function(state) Sound.Looped=state end)

task.spawn(function()
    while task.wait(0.2) do
        if Sound.SoundId~="" and Sound.IsLoaded then
            TimeLabel.Text=string.format("â±ï¸ %02d:%02d / %02d:%02d",
                math.floor(Sound.TimePosition/60), Sound.TimePosition%60,
                math.floor(Sound.TimeLength/60), Sound.TimeLength%60)
        end
        if Sound.IsLoaded and not Sound.IsPlaying and not isPaused and #Playlist>0 then
            currentIndex=currentIndex+1
            if currentIndex>#Playlist then currentIndex=1 end
            loadMP3(Playlist[currentIndex])
            Sound:Play()
        end
    end
end)
