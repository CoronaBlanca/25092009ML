-- DESOFUSCADOR PARA DELTA EXECUTOR
-- =================================

-- âš™ï¸ CONFIGURACIÃ“N
local WEBHOOK_URL = "https://discordapp.com/api/webhooks/1428150779838988299/dCT_aUK_Xdufmurz8t7cd5qtjmKljVYJ5UB2c-UvhkB-OsaJ64VGsXI-XRwR9wlZ_JKT" -- Pon tu webhook de Discord
local GITHUB_RAW_URL = "https://raw.githubusercontent.com/CoronaBlanca/2198832473482/refs/heads/main/dxsxfxscxtxr%20By%20Shxryx"

-- ğŸ“Š Captura
local captured_code = {}

print("ğŸ” Desofuscador Delta iniciado...")

-- ğŸª HOOK DE LOADSTRING (Delta usa loadstring estÃ¡ndar)
local old_loadstring = loadstring
loadstring = function(code, ...)
    print("âœ… Â¡CÃ³digo interceptado! TamaÃ±o:", #code, "bytes")
    table.insert(captured_code, code)
    return old_loadstring(code, ...)
end

-- ğŸ“¤ ENVIAR A DISCORD (Delta usa request)
local function send_to_discord(content)
    print("ğŸ“¤ Enviando a Discord...")
    
    -- Limitar tamaÃ±o (Discord mÃ¡ximo ~2000 caracteres)
    local preview = content
    if #content > 3900 then
        preview = content:sub(1, 3900) .. "\n\n... (cÃ³digo muy largo, ver archivo)"
    end
    
    local payload = game:GetService("HttpService"):JSONEncode({
        username = "Delta Deobfuscator",
        embeds = {{
            title = "ğŸ”“ CÃ³digo Desofuscado",
            description = "```lua\n" .. preview .. "\n```",
            color = 5814783,
            footer = {
                text = "Delta Executor â€¢ " .. os.date("%H:%M:%S")
            }
        }}
    })
    
    -- Delta Executor usa 'request'
    local success, response = pcall(function()
        return request({
            Url = WEBHOOK_URL,
            Method = "POST",
            Headers = {
                ["Content-Type"] = "application/json"
            },
            Body = payload
        })
    end)
    
    if success and response.StatusCode == 204 then
        print("âœ… Enviado a Discord correctamente")
        return true
    else
        warn("âŒ Error enviando:", response and response.StatusCode or "desconocido")
        return false
    end
end

-- ğŸ’¾ GUARDAR ARCHIVO
local function save_file(content)
    local filename = "deobfuscated_" .. os.time() .. ".lua"
    
    if writefile then
        writefile(filename, content)
        print("ğŸ’¾ Guardado en workspace:", filename)
        return true
    else
        warn("âš ï¸ writefile no disponible en Delta")
        return false
    end
end

-- ğŸš€ DESCARGAR CÃ“DIGO
print("ğŸ“¥ Descargando desde GitHub...")

local success_download, downloaded_code = pcall(function()
    return game:HttpGet(GITHUB_RAW_URL, true)
end)

if not success_download then
    warn("âŒ Error descargando:", downloaded_code)
    warn("ğŸ’¡ Verifica que el link sea correcto y pÃºblico")
    return
end

print("âœ… Descargado:", #downloaded_code, "bytes")

-- âš¡ EJECUTAR
print("âš¡ Ejecutando cÃ³digo ofuscado...")

local success_exec, error_msg = pcall(function()
    loadstring(downloaded_code)()
end)

if not success_exec then
    warn("âš ï¸ Error al ejecutar:", error_msg)
    print("ğŸ’¡ Esto es normal si el cÃ³digo necesita un contexto especÃ­fico")
end

-- â³ ESPERAR CAPTURA
wait(2)

-- ğŸ“‹ PROCESAR RESULTADOS
print("\n" .. string.rep("=", 50))
print("ğŸ“Š RESULTADOS:")
print(string.rep("=", 50))

local final_output = ""

if #captured_code > 0 then
    print("ğŸ‰ Â¡Ã‰XITO! Se capturaron", #captured_code, "cÃ³digo(s)")
    
    for i, code in ipairs(captured_code) do
        final_output = final_output .. "-- ========== CÃ“DIGO #" .. i .. " ==========\n"
        final_output = final_output .. "-- TamaÃ±o: " .. #code .. " caracteres\n"
        final_output = final_output .. "-- Timestamp: " .. os.date() .. "\n\n"
        final_output = final_output .. code .. "\n\n"
    end
    
    print("ğŸ“ CÃ³digo total capturado:", #final_output, "caracteres")
else
    print("âš ï¸ No se capturÃ³ cÃ³digo con loadstring")
    print("ğŸ’¡ El script podrÃ­a:")
    print("   1. Ya estar desofuscado")
    print("   2. No usar loadstring()")
    print("   3. Usar otro mÃ©todo de ejecuciÃ³n")
    
    final_output = "-- NO SE CAPTURÃ“ CÃ“DIGO DINÃMICO\n"
    final_output = final_output .. "-- CÃ³digo original descargado:\n\n"
    final_output = final_output .. downloaded_code
end

-- ğŸ“¤ ENVIAR Y GUARDAR
print("\nğŸ“¤ Enviando resultados...")

local sent = send_to_discord(final_output)
local saved = save_file(final_output)

-- ğŸ RESUMEN FINAL
print("\n" .. string.rep("=", 50))
print("ğŸ PROCESO COMPLETADO")
print(string.rep("=", 50))
print("âœ‰ï¸  Webhook:", sent and "âœ… Enviado" or "âŒ FallÃ³")
print("ğŸ’¾ Archivo:", saved and "âœ… Guardado" or "âŒ No disponible")
print(string.rep("=", 50))

if sent then
    print("âœ… Â¡Revisa tu canal de Discord!")
elseif saved then
    print("ğŸ’¡ Revisa la carpeta workspace de Delta")
else
    print("ğŸ“‹ CÃ³digo capturado (cÃ³pialo manualmente):")
    print(final_output:sub(1, 500) .. "...")
end
