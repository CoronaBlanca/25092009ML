--// CONFIGURACI√ìN
local webhooks = {
    Rebirths = "https://discord.com/api/webhooks/1430782885668851814/UPAdeg0ouObLOg84GHdhPC8gbyEMpFqhTwTARtMRSfKkKwHSF38-Bhsnl7bCgwgj7rqz",
    Kills = "https://discord.com/api/webhooks/1430782758052954223/l8n-ANnplP1G5adOmHrXBBFsRq7ezwA00oXRcBrGlXDZULM-D3AnGhjbY7mZ1u8RXE1D",
    Strength = "https://discord.com/api/webhooks/1430782119738867724/Xxp2_XheCEVz3Ot3a-NLW6jweSf5w3r1BMtqyKu3C3M3Z96z2lsPsrpYXtDKJawPKsmJ",
    MuscleKing = "https://discord.com/api/webhooks/1430783158286028841/3QAZmZL5WG37hCk1NrIKzjrG-MQeWNW3ux8irXqf3EC9suzQlRqM6bZZ2NsGQS4V3bPf",
    Brawls = "https://discord.com/api/webhooks/1430783011195977819/KtVFchlpGM6EXsIdN0QFywF3Hh4DV_Oa4xNeipjd2JeeOqMh4RkzlDoyYSqCbUh3kAFO"
}

--// SERVICIOS
local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local HttpService = game:GetService("HttpService")

--// LEADERBOARDS
local boards = {
    rebirthsLeaderboard = "Rebirths",
    killsLeaderboard = "Kills",
    strengthLeaderboard = "Strength",
    muscleKingLeaderboard = "MuscleKing",
    brawlsLeaderboard = "Brawls"
}

--// ENVIAR EMBED A WEBHOOK
local function sendToWebhook(webhookUrl, title, data)
    if not webhookUrl or webhookUrl == "" then
        warn("[‚ö†Ô∏è] No webhook URL para " .. title)
        return
    end
    local embed = {
        ["title"] = "üèÜ " .. title .. " Leaderboard",
        ["description"] = data,
        ["color"] = 0x483D8B,
        ["footer"] = { ["text"] = "On Top | Sherya System" },
        ["timestamp"] = DateTime.now():ToIsoDate()
    }
    local payload = HttpService:JSONEncode({
        ["username"] = "Leaderboard Bot",
        ["embeds"] = { embed }
    })
    request({
        Url = webhookUrl,
        Method = "POST",
        Headers = { ["Content-Type"] = "application/json" },
        Body = payload
    })
end

--// BUSCAR FRAMES DE JUGADORES
local function findFrames(parent)
    local frames = {}
    for _, obj in ipairs(parent:GetDescendants()) do
        if obj:IsA("Frame") and obj.Name == "playerEntry" then
            table.insert(frames, obj)
        end
    end
    return frames
end

--// PROCESAR Y ENVIAR
for boardName, boardLabel in pairs(boards) do
    local leaderboard = Workspace:FindFirstChild(boardName)
    if not leaderboard then
        warn("[‚ùå] No encontrado: " .. boardName)
        continue
    end

    local frames = findFrames(leaderboard)
    if #frames == 0 then
        warn("[‚ö†Ô∏è] No se encontraron jugadores en " .. boardLabel)
        sendToWebhook(webhooks[boardLabel], boardLabel, "Sin datos disponibles.")
        continue
    end

    local lines = {}
    local place = 1

    for _, entry in ipairs(frames) do
        local nameLabel = entry:FindFirstChild("nameLabel")
        local amountLabel = entry:FindFirstChild("amountLabel")

        local username = nameLabel and nameLabel:IsA("TextLabel") and nameLabel.Text or "N/A"
        local amount = amountLabel and amountLabel:IsA("TextLabel") and amountLabel.Text or "N/A"

        table.insert(lines, string.format("%d | %s : %s", place, username, amount))
        place += 1
    end

    local message = table.concat(lines, "\n")
    sendToWebhook(webhooks[boardLabel], boardLabel, message)
    print("[‚úÖ] Enviado leaderboard de " .. boardLabel .. " con " .. #lines .. " jugadores.")
end
